{% extends 'base.html' %}
{% load home %}

{% block content %}
<section class="container mt-5">
    <h1 class="mb-4">Select Shipping Address</h1>

    <div class="checkout-steps" style="margin-bottom: 2rem;">
        <div class="checkout-step">
            <div class="step-circle">1</div>
            <p class="step-label">Review Order</p>
        </div>
        <div class="checkout-step active">
            <div class="step-circle">2</div>
            <p class="step-label">Shipping Address</p>
        </div>
        <div class="checkout-step">
            <div class="step-circle">3</div>
            <p class="step-label">Payment</p>
        </div>
        <div class="checkout-step">
            <div class="step-circle">4</div>
            <p class="step-label">Confirmation</p>
        </div>
    </div>

    <div class="cart-container">
        <div style="background: var(--accent); border: 1px solid var(--border); border-radius: 8px; padding: 2rem;">
            <h5 style="margin-bottom: 1.5rem;">Available Addresses</h5>
            
            <form method="GET" action="{% url 'payment' %}">
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    {% for address in addresses %}
                        <label style="display: flex; align-items: center; padding: 1rem; border: 2px solid var(--border); border-radius: 8px; cursor: pointer; transition: all 0.3s ease;"
                               onmouseover="this.style.borderColor='var(--primary)'" 
                               onmouseout="this.style.borderColor='var(--border)'">
                            <input type="radio" name="address" value="{{ address.id }}" required>
                            <span style="margin-left: 1rem;">{{ address.address }}</span>
                        </label>
                    {% endfor %}
                </div>
                
                <div style="margin-top: 2rem;">
                    <button type="submit" class="btn btn-primary w-100">Continue to Payment</button>
                </div>
            </form>
            
            <div style="margin-top: 1rem;">
                <a href="{% url 'checkout' %}" class="btn btn-outline-primary w-100">Back</a>
            </div>
        </div>

        <div class="cart-summary">
            <h5 style="margin-bottom: 1.5rem;">Order Summary</h5>
            
            <div class="summary-row">
                <span>Subtotal:</span>
                <span>${{ total|floatformat:2 }}</span>
            </div>
            
            <div class="summary-row">
                <span>Shipping:</span>
                <span>$0.00</span>
            </div>
            
            <div class="summary-row">
                <span>Tax (8%):</span>
                <span>${{ total|multiply:0.08|floatformat:2 }}</span>
            </div>
            
            <div class="summary-row total">
                <span>Total:</span>
                <span>${{ total|multiply:1.08|floatformat:2 }}</span>
            </div>
            
            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                <p style="font-size: 0.9rem; color: var(--text-light);">{{ cart_items.count }} item{{ cart_items.count|pluralize }} in cart</p>
            </div>
        </div>
    </div>
</section>
{% endblock %}
